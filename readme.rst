Data-Driven Tractography
========================

.. _inference_t.ipynb: entrack/inference_t.ipynb
.. _training_conditional_t.ipynb: entrack/training_conditional_t.ipynb 
.. _fiber_resampling.ipynb: fiber_resampling.ipynb
.. _generate_conditional_samples_t.ipynb: generate_conditional_samples_t.ipynb
.. _trk2seeds.ipynb: trk2seeds.ipynb

.. _HCP project: https://db.humanconnectome.org
.. _TractSeg: https://zenodo.org/record/1477956#.XaN1YdszafZ

**Keywords**: Diffusion-Weighted MRI, Fiber Tracking, Machine Learning, Brain

Purpose
=======
This repository provides a utility to perform rapid prototyping of data-driven
tractography models.

Overview
========

Using the notebooks in this repository assumes a certain file structure:

| project/
| ├──models/
| ├──subjects/
| |  └──992774/
| |     ├──tracts/
| |     ├──resampled_fibers/
| |     ├──predicted_fibers/
| |     ├──samples/
| |     ├──seeds/
| |     └──fod.nii.gz
| ├──entrack/
| |  ├──inference_t.ipynb_
| |  └──training_conditional_t.ipynb_
| ├──fiber_resampling.ipynb_
| ├──generate_conditional_samples_t.ipynb_
| └──trk2seeds.ipynb_

The file system is described shortly, for more details please refer to the
individual files.

models/
-------
Contains keras models trained in training_conditional_t.ipynb_, along with
yaml configs, which contain the training parameters.

subjects/
---------
This is the data folder comprising DWI data, training fibers, and their
processed forms.
Specifically, we use T1 and DWI data from the `HCP project`_, and reference
fibers from TractSeg_.

* **tracts/** Raw fiber bundles (.trk), downloaded from TractSeg_.
* **resampled_fibers/** Fibers with data (.trk), interpolated by fiber_resampling.ipynb_
* **predicted_fibers/** Fibers (.trk), predicted by `inference_t.ipynb`_.
* **samples/** Collections of (vin, D, vout) samples (.npz), produced by generate_conditional_samples_t.ipynb_.
* **seeds/** Fiber seed files (.npy), generated by `generate_conditional_samples_t.ipynb`_.
* **fod.nii.gz** Additional DWI data, from `HCP project`_.

entrack/
--------
Folder for a specific model class, in this case Entrack. It defines how its
models are trained (training_conditional_t.ipynb_), and how they are used to
predict fibers (inference_t.ipynb_).

fiber_resampling.ipynb_
-------------------------
Notebook to resample fibers, and calculate local fiber geometry data, such as
tangent, curvature, and torsion.

generate_conditional_samples_t.ipynb_
---------------------------------------
Notebook which defines the generation of samples
(vin, D, vout) for learning the conditional
distribution p((vin| D, vout).

trk2seeds.ipynb_
------------------
Small utility notebook to convert the fiber endpoints in a .trk file to seed 
coordinates (.npy).
